---
import { getLocaleFromPathname, getNavigation, localizePath } from '@config/site';
import { Image } from 'astro:assets';
import logoMark from '@assets/shibaura-logo-mark.svg';
import MobileMenu from '@components/react/MobileMenu';

const { currentPathname } = Astro.props;
const locale = getLocaleFromPathname(currentPathname);
const navigation = getNavigation(locale);
const rfqHref = localizePath('/request-a-quote', locale);
const enHref = localizePath(currentPathname, 'en');
const frHref = localizePath(currentPathname, 'fr');
const isActiveLink = (href: string) : boolean => { return href === currentPathname; }

---

<header class="sticky top-0 z-50 w-full border-b border-slate-200 bg-white shadow-sm">
  <nav class="container mx-auto flex h-20 items-center justify-between px-4 sm:px-6 lg:px-8">
    <!-- Logo -->
    <div class="flex items-center">
      <a href="/" class="flex items-center space-x-2.5 group">
        <div class="flex items-center justify-center w-[52px] h-[52px] rounded-lg group-hover:scale-110 transition-transform">
          <span
            aria-hidden="true"
            class="w-[52px] h-[52px] brand-gradient-bg"
            style={`-webkit-mask-image: url(${logoMark.src}); mask-image: url(${logoMark.src}); -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat; -webkit-mask-position: center; mask-position: center; -webkit-mask-size: contain; mask-size: contain;`}
          ></span>
        </div>
        <span class="text-2xl font-bold brand-gradient-text">
          Portable Fire Pumps
        </span>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <div class="hidden lg:flex lg:items-center lg:space-x-1">
      {navigation.map((item) => {
        const isActive = isActiveLink(item.href);
        return (
        <a
          href={item.href}
          class={`px-4 py-2 text-sm font-medium text-slate-700 hover:text-[#E11D48] hover:bg-[#FFF1F2] rounded-lg transition-all relative group ${isActive ? 'nav-active' : ''}`}
        >
          {item.name}
        </a>
      );
      })}
    </div>

    <!-- Language Switcher -->
    <div class="hidden lg:flex lg:items-center">
      <div class="flex items-center space-x-2 text-xs font-semibold uppercase tracking-wide text-slate-500 px-[5px]">
        <a href={enHref} class="hover:text-[#E11D48] transition-colors">EN</a>
        <span class="text-slate-300">/</span>
        <a href={frHref} class="hover:text-[#E11D48] transition-colors">FR</a>
      </div>
    </div>

    <!-- CTA Button -->
    <div class="hidden lg:flex lg:items-center">
      <a
        href={rfqHref}
        class="inline-flex items-center px-6 py-2.5 text-sm font-semibold text-white bg-linear-to-r from-[#E11D48] to-[#F59E7E] hover:from-[#BE123C] hover:to-[#F8BFA8] rounded-lg shadow-md hover:shadow-lg transition-all"
      >
        Request Quote
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <MobileMenu client:idle items={navigation} rfqHref={rfqHref} />
  </nav>
</header>
